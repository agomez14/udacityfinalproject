/*!CK:947462674!*//*1436906169,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["mm1vk"]); }

__d("P2PTransferRiskResult",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={SUCCESS:"SUCCESS",UNDER_MANUAL_REVIEW:"UNDER_MANUAL_REVIEW",REQUIRE_VERIFICATION:"REQUIRE_VERIFICATION"};},null);
__d("XUIRadioList.react",["InputLabel.react","React","ReactChildren","XUIRadioInput.react","cloneWithProps"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=h,m=l.PropTypes,n=h.createClass({displayName:"XUIRadioList",propTypes:{name:m.string,onValueChange:m.func,selectedValue:m.any},render:function(){var o=i.map(this.props.children,function(p){return p===null?null:k(p,{name:this.props.name,onSelect:this.props.onValueChange,selectedValue:this.props.selectedValue});},this);return h.createElement("ul",h.__spread({},this.props,{name:null}),o);}});n.Item=h.createClass({displayName:"XUIRadioList.Item",propTypes:{name:m.string,onSelect:m.func,selectedValue:m.any,value:m.any,disabled:m.bool},render:function(){return (h.createElement("li",{className:this.props.className},h.createElement(g,{"aria-label":this.props['aria-label'],"data-hover":this.props['data-hover'],display:"inline"},h.createElement(j,{checked:this.props.selectedValue===this.props.value,name:this.props.name,onChange:this._handleChange,value:this.props.value,disabled:!!this.props.disabled}),h.createElement("label",null,this.props.children))));},_handleChange:function(event){this.props.onSelect&&this.props.onSelect(event.target.value);}});e.exports=n;},null);
__d("P2PChooseCreditCardForm.react",["CurrentEnvironment","Image.react","P2PCreditCard","React","XUIRadioList.react","XUIGrayText.react","cx","emptyFunction","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=k.Item,r=j,s=r.PropTypes,t='add_debit_card',u=g.messengerdotcom,v=j.createClass({displayName:"P2PChooseCreditCardForm",propTypes:{creditCards:s.arrayOf(s.instanceOf(i)),selectedCard:s.instanceOf(i).isRequired},getDefaultProps:function(){return {creditCards:[],selectedCard:null,onChange:n,onAddDebitCardOptionSelected:n,showAddDebitCardOption:false};},getInitialState:function(){return {selectedCard:this.props.selectedCard};},getSelectedCard:function(){return this.state.selectedCard;},onChange:function(w){var x;if(w===t){this.props.onAddDebitCardOptionSelected();}else{x=this.props.creditCards.filter(function(y){return y.getCredentialId()===w;})[0];this.setState({selectedCard:x});this.props.onChange(x);}},renderCardItem:function(w,x){return (j.createElement(q,{className:"_2x6n",key:'item-'+x,value:w.getCredentialId()},j.createElement(l,{className:"_3-8r _2jp9",shade:"dark",weight:"bold"},w.getName()),j.createElement(l,{shade:"dark",weight:"normal"},w.getCreditCardNumberFormatted()),j.createElement(h,{className:"_2x6p",height:24,src:w.getImage(),width:36})));},renderAddDebitCardRadioItem:function(){return (j.createElement(q,{className:"_2x6n _1gri",key:'item-'+this.props.creditCards.length,value:t},j.createElement(l,{className:"_3-8r _2jpa",shade:"dark"},o._("New Debit Card"))));},getRadioListItems:function(){var w=this.props.creditCards,x=w.map(this.renderCardItem);if(this.props.showAddDebitCardOption)x.push(this.renderAddDebitCardRadioItem());return x;},render:function(){return (j.createElement(k,{selectedValue:this.state.selectedCard.getCredentialId(),className:p(this.props.className,(("_2x6r")+(u?' '+"_2jpb":''))),onValueChange:this.onChange},this.getRadioListItems()));}});e.exports=v;},null);
__d("P2PEditCreditCardDialog.react",["CreditCardFormParam","CurrentEnvironment","Link.react","React","P2PAPI","P2PAPIUtils","P2PCreditCard","P2PCreditCardForm.react","P2PLoadingMask.react","P2PLinkConstants","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PButton.react","P2PText.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();'use strict';var y='fbP2PEditCreditCardDialog_learnMoreSentenceID',z=j,aa=z.PropTypes,ba=j.createClass({displayName:"P2PEditCreditCardDialog",propTypes:{asyncRequestState:aa.object.isRequired,creditCard:aa.instanceOf(m).isRequired,onCancel:aa.func.isRequired,onSuccess:aa.func.isRequired,saveButtonText:aa.string,showCancelButton:aa.bool},getInitialState:function(){return {formData:{},isValid:false,loading:false,requestID:'',saveErrors:null};},getDefaultProps:function(){return {saveButtonText:x._("Save"),showCancelButton:true,width:h.messengerdotcom?350:300};},componentWillReceiveProps:function(ca){var da=ca.asyncRequestState?ca.asyncRequestState[this.state.requestID]:null;if(da){this.setState({requestID:''});if(da.error){this.handleOnSaveError(da.error);}else this.handleOnSaveSuccess(da);}},clearSaveErrors:function(){this.setState({saveErrors:null});},onSaveClick:function(ca){var da={},ea=l.genRequestID();da[g.CREDENTIAL_ID]=this.props.creditCard.getCredentialId();this.clearSaveErrors();this.setState({loading:true,requestID:ea});k.updateCreditCard(Object.assign({requestID:ea},da,this.state.formData));},handleOnSaveSuccess:function(ca){this.props.onSuccess(ca);},onCancelClick:function(ca){this.props.onCancel();},handleOnSaveError:function(ca){this.setState({loading:false,saveErrors:ca});},isSaveDisabled:function(){return !this.state.isValid||this.state.loading;},isCancelDisabled:function(){return this.state.loading;},handleValidation:function(ca,da){this.setState({isValid:ca,formData:da});},getPrefilledFormData:function(){var ca={};ca[g.CARD_NUMBER]=this.props.creditCard.getCreditCardNumberMask();ca[g.CARD_EXPIRATION]=this.props.creditCard.getExpFormattedShort();ca[g.ZIP]=this.props.creditCard.getZipCode();return ca;},handleErrorDialogOKClick:function(){this.clearSaveErrors();},onToggle:function(ca){if(!ca)this.props.onCancel();},render:function(){var ca,da=this.props.text;if(!da)da=x._("Please update the expiration date for your card ending in {card numbers}.",[x.param("card numbers",this.props.creditCard.getCreditCardNumber())]);if(this.props.showCancelButton)ca=j.createElement(u,{use:"default",size:"medium",label:x._("Cancel"),disabled:this.isCancelDisabled(),onClick:this.onCancelClick});return (j.createElement(q,{behaviors:this.props.behaviors,layerHideOnBlur:false,onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:this.props.width},j.createElement(r,null,x._("Update Debit Card")),j.createElement(s,null,j.createElement(v,{className:"_3-96",type:"primary"},da),j.createElement(n,{onValidation:this.handleValidation,saveErrors:this.state.saveErrors,editMode:true,prefilledFormData:this.getPrefilledFormData(),cscMaxLength:this.props.creditCard.getMaxCSCLength()}),j.createElement(v,{className:"_3-8y",id:y,type:"secondary"},x._("Your payment info is stored securely. {Learn more about p2p link}",[x.param("Learn more about p2p link",j.createElement(i,{"aria-describedby":y,href:p.addDebitCardHelpURI,target:"_blank"},x._("Learn more.")))]))),j.createElement(t,null,ca,j.createElement(u,{use:"confirm",size:"medium",label:this.props.saveButtonText,disabled:this.isSaveDisabled(),onClick:this.onSaveClick})),j.createElement(o,{visible:this.state.loading})));}});e.exports=ba;},null);
__d("P2PConfirmAmountDialog.react",["CurrentEnvironment","React","P2PButton.react","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLoadingMask.react","P2PText.react","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();var r=h,s=r.PropTypes,t=g.messengerdotcom,u=h.createClass({displayName:"P2PConfirmAmountDialog",propTypes:{amount:s.string,currencySymbol:s.string,onCancel:s.func,onConfirm:s.func,receiverName:s.string},getDefaultProps:function(){return {amount:'',currencySymbol:'',onCancel:p,onConfirm:p,receiverName:s.string};},getInitialState:function(){return {loading:false};},handleCancelClick:function(){this.props.onCancel();},handleConfirmClick:function(){this.setState({loading:true});this.props.onConfirm();},getFormattedAmount:function(){var v=this.props.amount,w=(parseFloat(v)).toFixed(2);return this.props.currencySymbol+''+w;},render:function(){var v=t?350:300;return (h.createElement(j,{layerHideOnBlur:false,shown:true,width:v},h.createElement(m,{showCloseButton:false},q._("Confirm Payment")),h.createElement(k,null,h.createElement(o,{type:"primary"},q._("Do you want to pay {recipient name} {amount}?",[q.param("recipient name",this.props.receiverName),q.param("amount",this.getFormattedAmount())]))),h.createElement(l,null,h.createElement(i,{label:q._("Cancel"),onClick:this.handleCancelClick,use:"default"}),h.createElement(i,{label:q._("Pay"),onClick:this.handleConfirmClick,use:"confirm"})),h.createElement(n,{visible:this.state.loading})));}});e.exports=u;},null);
__d("P2PGroupSendDialog.react",["CurrentEnvironment","Image.react","MercuryIDs","MessengerContextualDialog.react","P2PActions","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PText.react","React","ScrollableArea.react","XUIContextualDialog.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();'use strict';var u=p,v=u.PropTypes,w=p.createClass({displayName:"P2PGroupSendDialog",propTypes:{amount:v.string,currency:v.string,onToggle:v.func.isRequired,participants:v.arrayOf(v.object).isRequired,threadFBID:v.string.isRequired},componentDidMount:function(){if(this.props.amount){this.log(m.UI_ACTN_INITIATE_GROUP_SEND_TRIGGER,{raw_amount:this.props.amount,currency:this.props.currency});}else this.log(m.UI_ACTN_INITIATE_GROUP_SEND);},log:function(x,y){l.log(x,Object.assign({www_event_flow:n.UI_FLOW_P2P_GROUP_SEND},y));},_handleToggle:function(x){this.props.onToggle(x);this.log(m.UI_ACTN_GROUP_SEND_CANCELLED);},_handleBlur:function(){this._handleToggle(false);},renderParticipantRow:function(x){var y=g.messengerdotcom,z=y?32:40,aa=!x.p2p_eligible,ba;if(aa)ba=p.createElement(o,{className:"_4cof",type:"primary"},t._("Isn't able to receive money right now"));return (p.createElement("li",{className:(("_4cog")+(aa?' '+"_4coh":'')),key:x.id,onClick:this.handleGroupThreadClicked.bind(this,x)},p.createElement("div",{className:"_4coi"},p.createElement(h,{className:"_4coj",height:z,src:x.big_image_src||x.image_src,width:z})),p.createElement("div",{className:"_4cok"},p.createElement(o,{className:"_4col",type:"primary"},x.name),ba)));},renderGroupList:function(){return (p.createElement(q,{height:178},p.createElement("ul",null,this.props.participants.map(this.renderParticipantRow))));},handleGroupThreadClicked:function(x){if(!x.p2p_eligible)return;var y=i.getThreadIDFromParticipantID(x.id);this.props.onToggle(false);k.chatSendViewOpened({amount:this.props.amount,threadID:y,groupThreadFBID:this.props.threadFBID});this.log(m.UI_ACTN_GROUP_SEND_RECIPIENT_PICKED,{raw_amount:this.props.amount,currency:this.props.currency,object_id:x.userID});},render:function(){var x=g.messengerdotcom,y=x?j:r,z=x?302:280;return (p.createElement(y,{alignment:x?'right':'left',context:this.props.context,onBlur:this._handleBlur,onToggle:this._handleToggle,shown:true,width:z,position:'above'},p.createElement("div",{className:(("_4com")+(x?' '+"_4con":''))},p.createElement(o,{className:"_4coo",type:"primary",weight:"bold"},t._("Who are you paying?")),this.renderGroupList())));}});e.exports=w;},null);
__d("P2PGroupSendReceiptDialog.react",["CurrentEnvironment","LeftRight.react","MessengerContextualDialog.react","P2PActions","P2PAmountUtils","P2PButton.react","P2PBigAmount.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PText.react","React","XUIContextualDialog.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();'use strict';var v=r,w=v.PropTypes,x=r.createClass({displayName:"P2PGroupSendReceiptDialog",propTypes:{currency:w.string.isRequired,onToggle:w.func.isRequired,groupSendReceiptDetails:w.object.isRequired,threadFBID:w.string.isRequired,threadID:w.string.isRequired},componentDidMount:function(){this.log(o.UI_ACTN_3RD_PARTY_LOG_MESSAGE_CLICKED,{raw_amount:this.props.groupSendReceiptDetails.amount,currency:this.props.currency});},log:function(y,z){n.log(y,Object.assign({www_event_flow:p.UI_FLOW_P2P_GROUP_SEND},z));},_handleToggle:function(y){this.props.onToggle(y);if(!y)this.log(o.UI_ACTN_3RD_PARTY_LOG_MESSAGE_CANCELLED);},_handleBlur:function(){this._handleToggle(false);},handleTryItClicked:function(){j.chatSendViewOpened({threadID:this.props.threadID,groupThreadFBID:this.props.threadFBID});this.log(o.UI_ACTN_3RD_PARTY_LOG_MESSAGE_TRY_CLICKED,{raw_amount:this.props.groupSendReceiptDetails.amount,currency:this.props.currency});},render:function(){var y=g.messengerdotcom,z=y?i:s,aa=y?302:280,ba=this.props.groupSendReceiptDetails,ca=r.createElement(q,{className:"_bpt",size:"small",type:y?"secondary":"primary"},u._("{sender name} sent {amount} to {receiver name}",[u.param("sender name",ba.senderName),u.param("amount",ba.amount),u.param("receiver name",ba.receiverName)]),".");return (r.createElement(z,{alignment:y?'right':'left',context:this.props.context,onBlur:this._handleBlur,onToggle:this._handleToggle,shown:true,width:aa,position:'above'},r.createElement("div",{className:(("_bpu")+(y?' '+"_bpv":''))},r.createElement(q,{className:"_bpw",type:"primary",weight:"bold"},u._("Payments in Messenger")),r.createElement("div",{className:"_2pi9"},r.createElement(q,{className:"_bpx",type:"secondary"},u._("Now you can send and receive money.")),r.createElement("div",{className:"_bpy"},r.createElement(m,{amount:k.sanitizeAmount(ba.amount)}),y?ca:null),!y?ca:null,r.createElement(h,{className:"_2pio"},r.createElement("div",null),r.createElement(l,{use:"confirm",size:"medium",label:u._("Try It"),type:"primary",onClick:this.handleTryItClicked}))))));}});e.exports=x;},null);
__d("P2PSendMoneyAmountInput.react",["CurrentEnvironment","React","XUIError.react","P2PAmountUtils","P2PText.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=h,p=o.PropTypes,q=g.messengerdotcom,r=h.createClass({displayName:"P2PSendMoneyAmountInput",propTypes:{currencySymbol:p.string,onInputChange:p.func,value:p.string},getDefaultProps:function(){return {currencySymbol:'$',onInputChange:m,value:''};},getInitialState:function(){return {inputError:null,maxInputWidth:q?236:100,value:this.props.value,width:''};},componentDidMount:function(){this.updateAmount(this.state.value);this.initDelayedFocus();},initDelayedFocus:function(){setTimeout(this.focus);},focus:function(){var s,t=this.state.value,u=0;if(this.isMounted()&&this.refs.textInput){s=h.findDOMNode(this.refs.textInput);s.focus();if(t){u=t.length;s.setSelectionRange(u,u);}}},handleAmountInputChange:function(s){var t=s.target.value;this.clearInputError();this.updateAmount(t);},clearInputError:function(){this.setState({inputError:null});},setInputError:function(s){this.setState({inputError:s});},updateAmount:function(s){var t=true,u,v=j.isAmountOverLegalLimit(s);s=j.sanitizeAmount(s);u=parseFloat(s);if(v){t=false;this.setInputError(n._("Please enter a smaller amount"));}var w=s.split('.'),x=w[0],y=w[1];if(y!==undefined){s=(x&&parseFloat(x)!==0?x:'0')+'.'+y.substr(0,2);}else if(x&&parseFloat(x)===0)s='0';this.setValue(s);u=parseFloat(s);t=t&&!isNaN(u)&&u>0;this.props.onInputChange(s,t);},setValue:function(s){this.setState({value:s},this.updateWidth);},updateWidth:function(){var s=this.getMockWidth();if(s)this.setState({width:Math.min(s,this.state.maxInputWidth)});},getMockWidth:function(){return h.findDOMNode(this.refs.mock_input).offsetWidth;},render:function(){var s;if(q&&!this.state.value.length)s=h.createElement("div",{ref:"placeholder_input",className:"_1-sv"},"0");return (h.createElement("div",{className:(("_ipw")+(q?' '+"_1-sw":''))},h.createElement("label",null,h.createElement(k,{className:"_3-91 _1-sx",display:"inline",type:"primary"},n._("Enter Amount")),h.createElement("div",{className:(("_4puh")+(!this.state.value.length?' '+"_1-sy":''))},h.createElement("div",{className:"_5fbp"},this.props.currencySymbol),s,h.createElement("div",{ref:"mock_input",className:"_5fbs"},this.state.value),h.createElement(i,{xuiError:this.state.inputError},h.createElement("span",{className:"_1-sz"},h.createElement("input",{className:"_5fbv",onChange:this.handleAmountInputChange,ref:"textInput",style:{width:this.state.width},value:this.state.value})))))));}});e.exports=r;},null);
__d("P2PVerifyCreditCardDialog.react",["CreditCardFormParam","CurrentEnvironment","P2PAPI","P2PAPIUtils","P2PCreditCard","P2PErrorNotice.react","P2PLoadingMask.react","React","P2PButton.react","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PCreditCardCVCFormField.react","P2PCreditCardZipCodeFormField.react","P2PDialogTitle.react","P2PText.react","cx","emptyFunction","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){b.__markCompiled&&b.__markCompiled();var aa=n,ba=aa.PropTypes,ca=n.createClass({displayName:"P2PVerifyCreditCardDialog",propTypes:{asyncRequestState:ba.object,creditCard:ba.instanceOf(k),onCancel:ba.func,onConfirm:ba.func,isPurchasing:ba.bool,isSending:ba.bool,purchaseName:ba.string,saveButtonText:ba.string,showCancelButton:ba.bool},getDefaultProps:function(){return {asyncRequestState:{},creditCard:null,isPurchasing:false,isSending:true,onCancel:x,onError:x,onSuccess:x,purchaseName:'',saveButtonText:y._("Confirm"),showCancelButton:true,width:h.messengerdotcom?320:300};},getInitialState:function(){var da={};da[g.CSC]={};da[g.CSC].valid=false;if(this.shouldShowZIPInput()){da[g.ZIP]={};da[g.ZIP].valid=false;}return {isValid:false,loading:false,requestID:'',saveError:null,fields:da};},componentWillReceiveProps:function(da){var ea=da.asyncRequestState?da.asyncRequestState[this.state.requestID]:null;if(ea){this.setState({requestID:''});if(ea.error){this.handleOnSaveError(ea.error);}else this.handleOnSaveSuccess(ea);}},handleOnSaveSuccess:function(da){this.props.onSuccess(da);},handleOnSaveError:function(da){this.setState({loading:false,saveError:da});},clearSaveError:function(){this.setState({saveError:null});},handleCancelClick:function(){this.props.onCancel();},handleConfirmClick:function(){var da={},ea=j.genRequestID();da[g.CREDENTIAL_ID]=this.props.creditCard.getCredentialId();da[g.CSC]=this.state.fields[g.CSC].value;if(this.state.fields[g.ZIP])da[g.ZIP]=this.state.fields[g.ZIP].value;this.clearSaveError();this.setState({loading:true,requestID:ea});i.verifyCreditCard(Object.assign({requestID:ea},da));},handleFormValueChange:function(da,ea,fa){var ga=this.state.fields;ga[da].value=ea;ga[da].valid=fa;this.setState({fields:ga});this.validateForm();},validateForm:function(){var da=true,ea=this.state.fields;da=!z(ea).some(function(fa){return !fa.valid;});this.setState({isValid:da});},handleToggle:function(da){if(!da)this.props.onCancel();},shouldShowZIPInput:function(){var da=!!(this.props.creditCard.getZipCode());return !da;},renderError:function(){var da;if(this.state.saveError)da=n.createElement(l,{error:this.state.saveError});return da;},renderCVCFormField:function(){return (n.createElement(s,{cscMaxLength:this.props.creditCard.getMaxCSCLength(),focused:true,onChange:this.handleFormValueChange,reference:'csc',showIcon:false,showPlaceholder:false,showFocusOutline:false}));},renderZIPFormField:function(){return (n.createElement(t,{onChange:this.handleFormValueChange,reference:'zip',showIcon:false,showPlaceholder:false,showFocusOutline:false}));},getMessage:function(){var da=this.props.creditCard.getName(),ea=this.props.creditCard.getCreditCardNumber();if(this.props.isPurchasing){if(this.shouldShowZIPInput()){return (n.createElement(v,{type:"primary"},y._("Enter the security code on the back of your {credit card issuer} ending in {credit card number last 4 digits} and Billing ZIP Code to get {Purchase item}.",[y.param("credit card issuer",da),y.param("credit card number last 4 digits",ea),y.param("Purchase item",this.props.purchaseName)])));}else return (n.createElement(v,{type:"primary"},y._("Enter the security code on the back of your {credit card issuer} ending in {credit card number last 4 digits} to get {Purchase item}.",[y.param("credit card issuer",da),y.param("credit card number last 4 digits",ea),y.param("Purchase item",this.props.purchaseName)])));}else if(this.props.isSending){if(this.shouldShowZIPInput()){return (n.createElement(v,{type:"primary"},y._("Enter the security code on the back of your {credit card issuer} ending in {credit card number last 4 digits} and Billing ZIP Code to send this payment.",[y.param("credit card issuer",da),y.param("credit card number last 4 digits",ea)])));}else return (n.createElement(v,{type:"primary"},y._("Enter the security code on the back of your {credit card issuer} ending in {credit card number last 4 digits} to send this payment.",[y.param("credit card issuer",da),y.param("credit card number last 4 digits",ea)])));}else if(this.shouldShowZIPInput()){return (n.createElement(v,{type:"primary"},y._("Enter the security code on the back of your {credit card issuer} ending in {credit card number last 4 digits} and Billing ZIP Code to accept this payment.",[y.param("credit card issuer",da),y.param("credit card number last 4 digits",ea)])));}else return (n.createElement(v,{type:"primary"},y._("Enter the security code on the back of your {credit card issuer} ending in {credit card number last 4 digits} to accept this payment.",[y.param("credit card issuer",da),y.param("credit card number last 4 digits",ea)])));},getInputs:function(){var da,ea=n.createElement("div",{className:"_3yfa"},n.createElement(v,{className:"_197h",type:"primary"},y._("Security Code")),n.createElement("div",{className:"_197i"},this.renderCVCFormField()));if(this.shouldShowZIPInput())da=n.createElement("div",{className:"_3yfb"},n.createElement(v,{className:"_197h",type:"primary"},y._("Billing ZIP Code")),n.createElement("div",{className:"_197i"},this.renderZIPFormField()));return (n.createElement("div",null,ea,da));},render:function(){var da;if(this.props.showCancelButton)da=n.createElement(o,{use:"default",size:"medium",label:y._("Cancel"),disabled:this.state.loading,onClick:this.props.onCancel});return (n.createElement(p,{behaviors:this.props.behaviors,className:((h.messengerdotcom?"_4ypw":'')),layerHideOnBlur:false,onToggle:this.handleToggle,ref:"dialog",repositionOnUpdate:true,shown:true,width:this.props.width},n.createElement(u,null,y._("Enter Security Code")),n.createElement(q,null,n.createElement("div",{className:"_197f"},this.getMessage()),this.renderError(),n.createElement("div",{className:"_197g"},this.getInputs())),n.createElement(r,null,da,n.createElement(o,{label:this.props.saveButtonText,onClick:this.handleConfirmClick,disabled:!this.state.isValid||this.state.loading,use:"confirm"})),n.createElement(m,{visible:this.state.loading})));}});e.exports=ca;},null);
__d("P2PSendMoneyDialog.react",["Arbiter","CreditCardFormParam","CurrentEnvironment","Image.react","ImageBlock.react","Link.react","MessengerContextualDialog.react","P2PAPI","P2PAddCreditCardDialog.react","P2PButton.react","P2PCreditCardStore","P2PChooseCreditCardForm.react","P2PConfirmAmountDialog.react","P2PEditCreditCardDialog.react","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PSendMoneyAmountInput.react","P2PText.react","P2PVerifyCreditCardDialog.react","React","ReactLayeredComponentMixin","XUIContextualDialog.react","cx","fbt","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha){b.__markCompiled&&b.__markCompiled();'use strict';var ia=ca,ja=ia.PropTypes,ka=i.messengerdotcom,la=ga._("Change"),ma=ga._("Add Debit Card"),na=100,oa=ca.createClass({displayName:"P2PSendMoneyDialog",mixins:[da],propTypes:{amount:ja.string,currency:ja.string.isRequired,currencySymbol:ja.string.isRequired,groupThreadFBID:ja.string,onError:ja.func,onSendSuccess:ja.func,onToggle:ja.func,receiver:ja.object},getDefaultProps:function(){return {amount:'',onError:ha,onSendSuccess:ha,onToggle:ha,receiver:{}};},getInitialState:function(){var pa=q.getAll();return {asyncRequestState:q.getAsyncRequestState(),addCreditCardDialogShown:false,amount:this.props.amount,creditCards:pa,confirmAmountDialogShown:false,isAmountValid:false,loading:false,selectedCard:pa[0],showChooseCreditCardForm:false,verifyCreditCardDialogShown:false};},_isAmountVerified:false,passwordCancelSubscribeToken:null,log:function(pa,qa){w.log(pa,Object.assign({www_event_flow:y.UI_FLOW_P2P_SEND,object_id:this.props.receiver.userID},qa));},componentWillUnmount:function(){if(this.passwordCancelSubscribeToken!==null){g.unsubscribe(this.passwordCancelSubscribeToken);this.passwordCancelSubscribeToken=null;}if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}},componentWillMount:function(){this.creditCardStoreSub=q.addListener('change',this.onCreditCardStoreChange);if(this.state.amount){this.log(x.UI_ACTN_INITIATE_SEND_TRIGGER,{raw_amount:this.state.amount,currency:this.props.currency});}else this.log(x.UI_ACTN_INITIATE_SEND);},onAmountInputChange:function(pa,qa){this.setState({amount:pa,isAmountValid:qa});},onCreditCardStoreChange:function(){var pa=q.getAll(),qa;if(this.state.selectedCard)qa=pa.filter(function(ra){return (ra.getCredentialId()===this.state.selectedCard.getCredentialId());}.bind(this))[0];if(!qa)qa=pa[0];this.setState({asyncRequestState:q.getAsyncRequestState(),creditCards:pa,selectedCard:qa});},shouldShowConfirmAmountDialog:function(){var pa=parseFloat(this.state.amount);return (!this._isAmountVerified&&pa>=na);},shouldShowVerifyCreditCardDialog:function(){return !this.state.selectedCard.getIsVerified();},shouldShowEditCreditCardDialog:function(){return this.state.selectedCard.isExpired();},handleSendClick:function(pa){if(this.isSendButtonDisabled())return false;this.log(x.UI_ACTN_SEND_CLICKED,{raw_amount:this.state.amount,currency:this.props.currency});this._isAmountVerified=false;this.initiatePayment();},initiatePayment:function(){if(this.shouldShowConfirmAmountDialog()){this.hideAllDialogs();this.setState({confirmAmountDialogShown:true});this.log(x.UI_ACTN_CONFIRM_AMOUNT,{raw_amount:this.state.amount,currency:this.props.currency});return;}else if(this.shouldShowEditCreditCardDialog()){this.hideAllDialogs();this.setState({editCreditCardDialogShown:true});this.log(x.UI_ACTN_EDIT_CARD,{raw_amount:this.state.amount,currency:this.props.currency});return;}else if(this.shouldShowVerifyCreditCardDialog()){this.hideAllDialogs();this.setState({verifyCreditCardDialogShown:true});this.log(x.UI_ACTN_VERIFY_CSC,{raw_amount:this.state.amount,currency:this.props.currency});return;}this.createTransaction();},shouldShowLoading:function(){return (!this.state.addCreditCardDialogShown&&!this.state.confirmAmountDialogShown&&!this.state.verifyCreditCardDialogShown&&!this.state.editCreditCardDialogShown);},createTransaction:function(){var pa={};this.setState({loading:this.shouldShowLoading()});pa[h.CREDENTIAL_ID]=this.state.selectedCard.getCredentialId();pa.amount=this.state.amount;pa.receiverId=this.props.receiver.userID;if(this.props.groupThreadFBID)pa.group_thread_fbid=this.props.groupThreadFBID;this.passwordCancelSubscribeToken=g.subscribeOnce('PasswordReauthDialogCancelClick',this.handlePasswordReauthDialogCancelClick);n.createTransaction({formData:pa,error:this.setCreateTransferError,success:this.setCreateTransferSuccess});this.log(x.UI_ACTN_CONFIRM_SEND,{raw_amount:this.state.amount,currency:this.props.currency});},hideAllDialogs:function(){this.setState({addCreditCardDialogShown:false,confirmAmountDialogShown:false,verifyCreditCardDialogShown:false,editCreditCardDialogShown:false});},setCreateTransferError:function(pa){if(this.isMounted()){this.hideAllDialogs();this.setState({loading:false});}this.props.onError(pa);this.log(x.UI_ACTN_SEND_FAIL);},setCreateTransferSuccess:function(pa){if(this.isMounted()){this.setState({loading:false});this.hideAllDialogs();}this.props.onSendSuccess(pa);this.log(x.UI_ACTN_SEND_SUCCESS);},handlePasswordReauthDialogCancelClick:function(){this.passwordCancelSubscribeToken=null;this.setState({loading:false});this.hideAllDialogs();},onAddCreditCardCancel:function(){this.setState({addCreditCardDialogShown:false});},onAddCreditCardSuccess:function(pa){var qa=this.state.creditCards.filter(function(ra){var sa=ra.getCredentialId();return (pa[h.CREDENTIAL_ID]===sa);})[0];this.setState({selectedCard:qa});if(this.state.isAmountValid){this.initiatePayment();}else{this.setState({addCreditCardDialogShown:false});this.focusAmountInput();}},onEditCreditCardSuccess:function(){this.initiatePayment();},onEditCreditCardCancel:function(){this.setState({editCreditCardDialogShown:false});},focusAmountInput:function(){if(this.refs.send_money_amount_input)ca.findDOMNode(this.refs.send_money_amount_input).focus();},_handleToggle:function(pa){this.props.onToggle(pa);if(!this.state.loading)this.log(x.UI_ACTN_SEND_MONEY_CANCELLED);},_handleBlur:function(){this._handleToggle(false);},handleAddCreditCardClick:function(){this.setState({addCreditCardDialogShown:true,showChooseCreditCardForm:false});this.log(x.UI_ACTN_CHANGE_CARD);},handleBackClick:function(){this.setState({showChooseCreditCardForm:false},function(){this.focusAmountInput();});},handleChooseCardNextClick:function(){var pa=this.refs.choose_credit_card_form.getSelectedCard();this.setState({selectedCard:pa,showChooseCreditCardForm:false},function(){this.focusAmountInput();});},handleAddCardNextClick:function(){this.setState({addCreditCardDialogShown:true});},handleChangeSelectedCardClick:function(){var pa={};if(this.state.creditCards.length===1){pa.addCreditCardDialogShown=true;this.log(x.UI_ACTN_CHANGE_CARD);}else{pa.showChooseCreditCardForm=true;this.log(x.UI_ACTN_INITIATE_CHOOSE_CARD);}this.setState(pa);},onConfirmAmountCancel:function(){this.setState({confirmAmountDialogShown:false});},onConfirmAmountSuccess:function(){this._isAmountVerified=true;this.initiatePayment();},onVerifyCreditCardSuccess:function(){this.initiatePayment();},onVerifyCreditCardCancel:function(){this.setState({verifyCreditCardDialogShown:false});},isSendButtonDisabled:function(){return (!this.state.isAmountValid||!this.state.creditCards.length||this.state.loading);},isAddCardNextButtonDisabled:function(){return !this.state.isAmountValid;},renderAddDebitCardLink:function(){return (ca.createElement(aa,{className:"_42h3",type:"secondary",ref:"send_money_dialog_add_card_text"},ca.createElement(l,{className:"_49nm",href:"#",onClick:this.handleAddCreditCardClick},ma)));},renderSelectedCard:function(){var pa=this.state.selectedCard;return (ca.createElement(aa,{className:"_21x5",size:"small",type:"primary"},ca.createElement("div",{className:"_49nn"},pa.getName()),ca.createElement("div",{className:"_21wx"},pa.getCreditCardNumberFormatted()),ca.createElement("div",{className:"_21ww"},'\u00b7'),ca.createElement(l,{className:"_21wy",onClick:this.handleChangeSelectedCardClick,href:"#"},la)));},renderFormButtons:function(){var pa;if(!this.state.creditCards.length){pa=this.renderAddCardNextButton();}else if(this.state.showChooseCreditCardForm){pa=ca.createElement("div",null,this.renderChooseCardBackButton(),this.renderChooseCardNextButton());}else pa=this.renderPayButton();return pa;},renderChooseCardBackButton:function(){return (ca.createElement(p,{className:"_2abj",label:ga._("Back"),onClick:this.handleBackClick,ref:"back_button",size:"medium",type:"secondary",use:"default"}));},renderAddCardNextButton:function(){return (ca.createElement(p,{className:"_5p-b",disabled:this.isAddCardNextButtonDisabled(),label:ga._("Next"),onClick:this.handleAddCardNextClick,ref:"add_card_next_button",size:"medium",type:"primary",use:"default"}));},renderChooseCardNextButton:function(){return (ca.createElement(p,{label:ga._("Next"),onClick:this.handleChooseCardNextClick,ref:"choose_card_next_button",size:"medium",type:"primary",use:"confirm"}));},renderPayButton:function(){return (ca.createElement(p,{className:"_21x6 _5p-b",disabled:this.isSendButtonDisabled(),label:ga._("Pay"),onClick:this.handleSendClick,ref:"send_button",size:"medium",type:"primary",use:"confirm"}));},renderPaymentDetails:function(){var pa;if(this.state.creditCards.length){if(this.state.showChooseCreditCardForm){pa=this.renderAddDebitCardLink();}else pa=this.renderSelectedCard();}else pa=ca.createElement("div",{className:"_2abl"},ca.createElement(aa,{type:"secondary",ref:"send_money_dialog_add_card_next_text"},ga._("Sending money is free and secure")));return pa;},renderSendMoneyForm:function(){var pa=ka?32:40;return (ca.createElement("div",null,ca.createElement("div",{className:"_49no _2pi4",ref:"send_money_dialog_title"},ca.createElement(k,{spacing:"large"},ca.createElement(j,{className:"_5p-i",height:pa,src:this.props.receiver.big_image_src||this.props.receiver.image_src,width:pa}),ca.createElement("div",{className:"_3-8w"},ca.createElement(aa,{type:"secondary"},ga._("Send to")),ca.createElement(aa,{className:"_5p-j",size:"small",type:"primary",weight:"bold"},this.props.receiver.name))),ca.createElement(l,{className:"_49np",href:u.helpCenterURI,target:"_blank"})),ca.createElement("div",{className:"_2abm"},this.renderMainContainer()),ca.createElement("div",{className:(("_21w-")+(ka?' '+"_4eb_":''))},ca.createElement("div",{className:"_5p-k"},ca.createElement("div",{className:"_21x4"},this.renderPaymentDetails()),ca.createElement("div",{className:"_4zf-"},this.renderFormButtons())))));},renderMainContainer:function(){var pa;if(this.state.showChooseCreditCardForm){pa=ca.createElement("div",{className:"_xn7"},ca.createElement(r,{creditCards:this.state.creditCards,selectedCard:this.state.selectedCard,ref:"choose_credit_card_form"}));}else pa=ca.createElement("div",{className:"_2abn"},ca.createElement(z,{currencySymbol:this.props.currencySymbol,onInputChange:this.onAmountInputChange,ref:"send_money_amount_input",value:this.state.amount}));return pa;},renderLayers:function(){var pa={},qa;if(this.state.addCreditCardDialogShown){if(this.state.isAmountValid)qa=ga._("Pay");pa.addCreditCard=ca.createElement(o,{eventFlow:y.UI_FLOW_P2P_SEND,ref:"send_money_dialog_add_credit_card_form",onCancel:this.onAddCreditCardCancel,onSuccess:this.onAddCreditCardSuccess,showCancelButton:!ka?false:true,saveButtonText:qa});}else if(this.state.confirmAmountDialogShown){pa.confirmAmount=ca.createElement(s,{amount:this.state.amount,currencySymbol:this.props.currencySymbol,onCancel:this.onConfirmAmountCancel,onConfirm:this.onConfirmAmountSuccess,receiverName:this.props.receiver.short_name});}else if(this.state.verifyCreditCardDialogShown){pa.verifyCreditCard=ca.createElement(ba,{asyncRequestState:this.state.asyncRequestState,creditCard:this.state.selectedCard,isSending:true,onCancel:this.onVerifyCreditCardCancel,onSuccess:this.onVerifyCreditCardSuccess});}else if(this.state.editCreditCardDialogShown)pa.confirmAmount=ca.createElement(t,{asyncRequestState:this.state.asyncRequestState,creditCard:this.state.selectedCard,onCancel:this.onEditCreditCardCancel,onSuccess:this.onEditCreditCardSuccess});return pa;},render:function(){var pa=ka?m:ea,qa=ka?286:260;return (ca.createElement(pa,{alignment:ka?'right':'left',context:this.props.context,onBlur:this._handleBlur,onToggle:this._handleToggle,shown:true,width:qa,position:this.props.position||'above'},ca.createElement("div",{className:(("_21x9")+(ka?' '+"_1pka":''))},this.renderSendMoneyForm(),ca.createElement(v,{ref:"send_money_dialog_loader",visible:this.state.loading}))));}});e.exports=oa;},null);