/*!CK:3860319277!*//*1436279385,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["UzZg4"]); }

__d("MessengerSearchInput.react",["AbstractTextInput.react","ReactComponentWithPureRenderMixin","React","XUICloseButton.react","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"MessengerSearchInput",mixins:[h],propTypes:{isFocused:n.bool,onBlur:n.func,onChange:n.func,onClear:n.func,onEnter:n.func,onFocus:n.func,placeholder:n.string,value:n.string},render:function(){return (i.createElement("div",{className:l(this.props.className,(("_5iwm")+(this.props.isFocused||!!this.props.value?' '+"_5iwn":'')))},i.createElement(g,{className:"_3deo",onBlur:this.props.onBlur,onChange:this.props.onChange,onEnter:this.props.onEnter,onFocus:this.props.onFocus,placeholder:this.props.placeholder,ref:"inputField",value:this.props.value}),i.createElement(j,{size:"small",onMouseDown:this.props.onClear,className:((this.props.value.length===0?"hidden_elem":'')+(' '+"_2xme"))})));},focusInput:function(){this.refs.inputField.focusInput();}});e.exports=o;},null);
__d("StickerSearch",["StickerServerRequests"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h,i,j={},k={requestStickersForQuery:function(l,m){h=l;g.getStickersForQuery(l,function(n){return h===l&&m(n.payload);});},prepareTagsData:function(){if(!i)i=g.fetchTagData(function(l){j=l;});return i;},getTagByName:function(l){return j[l];},getTagsIndex:function(){return j;}};e.exports=k;},null);
__d("StickersFlyoutStickerSelector.react",["BanzaiLogger","Grid.react","Image.react","ScrollableArea.react","React","Sticker.react","StickerConstants","StickerConfig","StickerImages","StickerInterfaces","StickerSearch","StickerState","StickerUtils","XUISpinner.react","cx","debounce","emptyFunction","fbt","getObjectValues","ix","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){b.__markCompiled&&b.__markCompiled();'use strict';var ba=h.GridItem,ca=k,da=ca.PropTypes,ea=320,fa=278,ga=m.MRU_STICKER_PACK,ha=44,ia=112,ja=v(function(la,ma){if(!la)return;g.log('StickersLoggerConfig',{event:'search_sticker',searchtoken:la,numsearchresults:ma.length});},1000),ka=k.createClass({displayName:"StickersFlyoutStickerSelector",propTypes:{height:da.number,stickerInterface:da.oneOf(y(p)),onQueryResultsFound:da.func,onScroll:da.func,packID:da.string,singleWordTags:da.array,typeaheadTags:da.array,userInput:da.string},getDefaultProps:function(){return {stickerInterface:p.MESSAGES,onScroll:w};},getInitialState:function(){return {loading:false,stickers:[]};},componentDidMount:function(){if(this.props.packID){this.requestStickersForPack(this.props.packID);return;}if(this.props.userInput)this.requestStickersForQuery(this.props.userInput);},componentWillReceiveProps:function(la){if(la.packID&&la.packID!==this.props.packID){this.requestStickersForPack(la.packID);}else if(la.userInput!==this.props.userInput)this.requestStickersForQuery(la.userInput);},requestStickersForQuery:function(la){this.setState({loading:true});q.requestStickersForQuery(la,function(ma){ma.map(function(na){return o.cacheSticker(na);});if(!this.props.tagChosen)ja(la,ma);if(this.props.stickerInterface==p.COMPOSER)ma=ma.filter(function(na){return na.isComposerCapable;});if(this.props.stickerInterface==p.COMMENTS)ma=ma.filter(function(na){return na.isCommentsCapable;});if(this.props.stickerInterface==p.MESSAGES)ma=ma.filter(function(na){return na.isMessengerCapable;});if(this.isMounted()){this.setState({loading:false,stickers:ma});if(n.EnterToSendSticker)this.props.onQueryResultsFound&&this.props.onQueryResultsFound(ma);}}.bind(this));},requestStickersForPack:function(la){this.setState({loading:true});o.requestStickersForPack(la,m.TRAY_SIZE,function(ma){if(la==ga){ma=r.getMRUStickerPack(ma);if(this.props.stickerInterface==p.COMPOSER)ma=ma.filter(function(na){return na.isComposerCapable;});if(this.props.stickerInterface==p.COMMENTS)ma=ma.filter(function(na){return na.isCommentsCapable;});if(this.props.stickerInterface==p.MESSAGES)ma=ma.filter(function(na){return na.isMessengerCapable;});}this.setState({loading:false,stickers:ma});}.bind(this));},renderStickers:function(){return this.state.stickers.map(function(la){var ma=s.getScaledDimensions(la.height,la.width,m.TRAY_SIZE);return (k.createElement(ba,{key:la.id},k.createElement("div",{className:"_5r8h","data-id":la.id},k.createElement(l,{animationTrigger:"hover",className:"_5r8i",forceCursorPointer:true,frameCount:la.frameCount,frameRate:la.frameRate||83,framesPerCol:la.framesPerCol,framesPerRow:la.framesPerRow,sourceHeight:ma.height,sourceURI:la.sourceURI,sourceWidth:ma.width,spriteURI:la.spriteURI,paddedSpriteURI:la.paddedSpriteURI,stickerID:la.id}))));});},_onScroll:function(){var la=this.refs.stickerScrollable;if(la){var ma=la.getArea().getScrollTop();this.props.onScroll(ma);}},render:function(){if(this.state.loading){return (k.createElement("div",{className:"_e0r"},k.createElement(t,{size:"large"})));}else if(this.state.stickers.length===0){var la=(ea-ha*2-ia)/2+"px";return (k.createElement("div",{className:"_5jdt",style:{marginTop:la}},k.createElement(i,{src:z("/images/messaging/stickers/icons/sad_face.png")}),k.createElement("p",null,x._("No Stickers to Show"))));}return (k.createElement(j,{ref:"stickerScrollable",height:this.props.height||ea,onScroll:aa(this._onScroll,200),width:fa,fade:true},k.createElement("div",{className:"_5r8k"},k.createElement(h,{cols:4,fixed:true},this.renderStickers()))));}});e.exports=ka;},null);
__d("MessengerStickersFlyoutTagSelector.react",["BanzaiLogger","Grid.react","ScrollableArea.react","Parent","React","Image.react","StickerConfig","StickerConstants","MessengerSearchInput.react","StickersFlyoutStickerSelector.react","StickerSearch","StickerState","StickerUtils","Toggler","XUIButton.react","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();'use strict';var y=h.GridItem,z=k,aa=z.PropTypes,ba=320,ca=278,da=44,ea=k.createClass({displayName:"MessengerStickersFlyoutTagSelector",propTypes:{trigger:aa.string,isComments:aa.bool,isComposer:aa.bool,resetTrigger:aa.func,shown:aa.bool,onSelectSticker:aa.func},getInitialState:function(){return {input:'',isScrolling:false,tagChosen:false,isInputFocused:false,matchedStickers:[]};},getDefaultProps:function(){return {trigger:null,isComments:false,isComposer:false,resetTrigger:w,shown:false,onSelectSticker:w};},componentDidMount:function(){var fa=j.byClass(k.findDOMNode(this),'uiToggle');if(fa)this._togglerSub=t.listen('show',fa,function(){this.isMounted()&&this.focusInput();}.bind(this));this.focusInput();this.selectTrigger(this.props.trigger);},componentWillUnmount:function(){this._togglerSub&&this._togglerSub.unsubscribe();},componentWillReceiveProps:function(fa){this.selectTrigger(fa.trigger);},focusInput:function(){this.refs.inputField.focusInput&&this.refs.inputField.focusInput();},_setMatchedStickers:function(fa){this.setState({matchedStickers:fa?fa:[]});},_onEnter:function(fa){fa.preventDefault();fa.stopPropagation();if(!m.EnterToSendSticker)return;var ga=this.state.matchedStickers;if(ga&&ga.length===1){this.props.onSelectSticker(ga[0].id,fa);this.setState({matchedStickers:[]});}},_onInputFocused:function(){this.setState({isInputFocused:true});},_onInputBlurred:function(){this.setState({isInputFocused:false});},_inputChanged:function(event){var fa=event.target.value;if(!fa)this.reset();this.setState({input:fa,tagChosen:false,isScrolling:false});},_normalizeInput:function(fa){return fa.trim().replace(/\s+/,' ').toLowerCase();},reset:function(){this.setState({input:'',isScrolling:false,tagChosen:false,matchedStickers:[]});},renderContentArea:function(){if(this.state.tagChosen||this._normalizeInput(this.state.input).length>1){return this.renderStickers();}else return m.StickerSearchInRecent?this.renderRecentStickers():this.renderTags();},render:function(){return (k.createElement("div",{className:(("_217a")+(this.state.isScrolling?' '+"_1hg1":'')+(this.state.isInputFocused?' '+"_10cj":''))},k.createElement(o,{isFocused:this.state.isInputFocused,onBlur:this._onInputBlurred,onChange:this._inputChanged,onClear:this.reset,onEnter:this._onEnter,onFocus:this._onInputFocused,placeholder:x._("Search all Stickers"),ref:"inputField",value:this.state.input}),this.renderContentArea()));},selectTag:function(fa){g.log('StickersLoggerConfig',{event:'select_tag',tagid:fa.id});this.setState({tagChosen:true,input:s.capitalizeWords(fa.name)});this.focusInput();},selectTrigger:function(fa){if(fa!==null){var ga=q.getTagByName(fa);this.setState({tagChosen:true,input:s.capitalizeWords(ga.name)});this.props.resetTrigger();}},_onScroll:function(fa){this.setState({isScrolling:!!fa});},renderStickers:function(){var fa=this._normalizeInput(this.state.input);return (k.createElement(p,{ref:"selector",height:ba-da,userInput:fa,onScroll:this._onScroll,isComments:this.props.isComments,isComposer:this.props.isComposer,tagChosen:this.state.tagChosen,shown:this.props.shown,onQueryResultsFound:this._setMatchedStickers}));},renderRecentStickers:function(){if(this._normalizeInput(this.state.input).length===1)return k.createElement("div",null);return (k.createElement(p,{ref:"selector",height:ba-da,packID:n.MRU_STICKER_PACK,onScroll:this._onScroll,isComments:this.props.isComments,isComposer:this.props.isComposer,shown:this.props.shown}));},renderTags:function(){var fa=r.getFeaturedTags().filter(function(ga){return ga.sourceURI!==null;}).sort(function(ga,ha){return ga.order-ha.order;}).map(function(ga,ha){return k.createElement(y,{key:ha},k.createElement("div",{className:(("_t5c")+(' '+"_10m5")+(ha<2?' '+"_1b27":'')+(ha%2===0?' '+"_t5d":'')+(ha%2!==0?' '+"_t5e":''))},k.createElement(u,{image:k.createElement(l,{src:ga.sourceURI}),label:ga.name,onClick:this.selectTag.bind(this,ga),className:(("_5jdu")+(' '+"_10m6")),style:{background:'#'+ga.color_code},disabled:this._normalizeInput(this.state.input).length===1})));}.bind(this));return (k.createElement(i,{height:ba-da,width:ca-16,shadow:true,fade:true,className:"_5jei _10m7"},k.createElement(h,{spacing:"pas",cols:2,fixed:true,ref:"grid"},fa)));}});e.exports=ea;},null);
__d("MessagesEmoticons.react",["Grid.react","React","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=g.GridItem,m=h,n=m.PropTypes,o=8,p={smile:k._("smile"),frown:k._("frown"),tongue:k._("tongue"),grin:k._("grin"),gasp:k._("gasp"),wink:k._("wink"),pacman:k._("pacman"),grumpy:k._("grumpy"),unsure:k._("unsure"),cry:k._("cry"),kiki:k._("kiki"),glasses:k._("glasses"),sunglasses:k._("sunglasses"),heart:k._("heart"),devil:k._("devil"),angel:k._("angel"),squint:k._("squint"),confused:k._("confused"),upset:k._("upset"),colonthree:k._("colonthree"),like:k._("like")},q=h.createClass({displayName:"MessagesEmoticons",propTypes:{onEmoticonSelect:n.func},getDefaultProps:function(){return {onEmoticonSelect:j};},getEmoticons:function(){return Object.keys(p).map(function(r){return (h.createElement(l,{key:r},h.createElement("div",{className:"panelCell"},h.createElement("a",{"aria-label":p[r],className:'emoticon emoticon_'+r,onClick:function(){return this.props.onEmoticonSelect(r);}.bind(this)}))));}.bind(this));},render:function(){return (h.createElement("div",{className:"emoticonsTable"},h.createElement(g,{cols:o,alignv:"middle",alignh:"center",spacing:"pam"},this.getEmoticons())));}});e.exports=q;},null);
__d("StickersFlyoutPackSelector.react",["Animation","ImmutableObject","Locale","React","Image.react","StickerActions","StickerConfig","StickerConstants","StickerInterfaces","StickerState","StickerStoreController","XUIBadge.react","cx","emptyFunction","fbt","ix","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();'use strict';var x=j,y=x.PropTypes,z=4,aa=200,ba=u._("Sticker Store"),ca=j.createClass({displayName:"StickersFlyoutPackSelector",propTypes:{stickerInterface:y.oneOf(w(o)),numNewPacks:y.number,packs:y.arrayOf(y.instanceOf(h)).isRequired,onPackClick:y.func,selectedPackID:y.string,resetTagSelectorFunc:y.func},getInitialState:function(){return {animating:false,page:0};},getDefaultProps:function(){return {stickerInterface:o.MESSAGES,numNewPacks:0};},shouldComponentUpdate:function(ea,fa){return !fa.animating;},onFlyoutShown:function(){if(this.props.packs.length>0){var ea=this._calculatePageForPack(this.props.selectedPackID);if(this.state.page!==ea)this._setPage(ea,0);}},_calculatePageForPack:function(ea){for(var fa=0;fa<this.props.packs.length;fa++)if(this.props.packs[fa].id==ea)return fa<=z?0:Math.floor((fa-1)/z);return 0;},_setPage:function(ea,fa){if(this.state.animating)return;this.setState({animating:true,page:ea},function(){var ga=j.findDOMNode(this.refs.positioner),ha=this._calculatePosition(ea);new g(ga).to(ha.reference,ha.offset+'px').ondone(function(){return this.setState({animating:false});}.bind(this)).duration(fa).go();});},_calculatePosition:function(ea){var fa=j.findDOMNode(this.refs.positioner),ga=fa.childNodes[ea].offsetLeft;if(i.isRTL()){var ha=fa.offsetWidth,ia=fa.childNodes[ea].offsetWidth;return {reference:'right',offset:ga+ia-ha};}return {reference:'left',offset:-ga};},_numPages:function(){return Math.max(1,Math.ceil((this.props.packs.length-1)/z));},_canGoPrev:function(){return this.state.page>0;},_canGoNext:function(){return this.state.page+1<this._numPages();},_goPrev:function(){this._canGoPrev()&&this._setPage(this.state.page-1,aa);},_goNext:function(){this._canGoNext()&&this._setPage(this.state.page+1,aa);},_openStore:function(){l.resetNumNewPacks();var ea=this.props.stickerInterface==o.COMPOSER;q.showStore(null,ea);},render:function(){return (j.createElement("div",{className:"_5r85"},this._renderStoreButton(),this._renderPrevArrow(),this._renderNextArrow(),j.createElement("div",{className:"_5r88"},j.createElement("div",{className:"_5r89",ref:"positioner"},this._renderPages()))));},_selectPack:function(ea){var fa=p.getPack(ea);if(fa&&fa.isPromoted)l.addPack(ea);if(ea===n.SEARCH_PACK_ID)this.props.resetTagSelectorFunc();l.selectPack(ea);},_renderPages:function(){var ea=this.props.packs.map(function(ia,ja){return j.createElement(da,{key:ia.id,onClick:function(){return this._selectPack(ia.id);}.bind(this),pack:ia,selected:this.props.selectedPackID===ia.id,index:ja,isComments:this.props.stickerInterface==o.COMMENTS});}.bind(this)),fa=[];for(var ga=0;ga<ea.length;ga+=z){var ha=ga;ga===0&&ga++;fa.push(j.createElement("div",{className:"_5r81",key:ga},ea.slice(ha,ga+z)));}return fa;},_renderStoreButton:function(){return (j.createElement("a",{"aria-label":ba,className:"_5r86 rfloat","data-hover":"tooltip",onClick:this._openStore},j.createElement(k,{className:"_5r87",src:v('/images/messaging/stickers/selector/sticker_store.png')}),this._renderJewel()));},_renderJewel:function(){var ea=this.props.numNewPacks;if(!ea)return null;return (j.createElement(r,{className:"rfloat _3fhs",count:ea,maxcount:9,type:"special"}));},_renderPrevArrow:function(){if(!this._canGoPrev())return null;var ea=i.isRTL()?v('/images/messaging/stickers/selector/right.png'):v('/images/messaging/stickers/selector/left.png');return (j.createElement("a",{className:(("_37wu")+(' '+"lfloat")),onClick:this._goPrev},j.createElement(k,{className:"_5r84",src:ea})));},_renderNextArrow:function(){if(!this._canGoNext())return null;var ea=i.isRTL()?v('/images/messaging/stickers/selector/left.png'):v('/images/messaging/stickers/selector/right.png');return (j.createElement("a",{className:(("_37wv")+(' '+"rfloat")),onClick:this._goNext},j.createElement(k,{className:"_5r84",src:ea})));}}),da=j.createClass({displayName:"PackIcon",propTypes:{index:y.number,isComments:y.bool,onClick:y.func,pack:y.instanceOf(h).isRequired,selected:y.bool},getDefaultProps:function(){return {isComments:false,onClick:t};},_getPackIcon:function(ea){if(ea.id==n.SEARCH_PACK_ID)return v('/images/messaging/stickers/icons/search.png');if(ea.id==n.MRU_STICKER_PACK)return v('/images/messaging/stickers/icons/recent.png');if(ea.id==n.EMOTICON_PACK_ID)return v('/images/messaging/stickers/icons/emoji.png');return ea.icon;},render:function(){var ea=this.props.pack,fa=m.WebStickerSearch&&!m.StickerSearchInRecent?this.props.index===1||this.props.index===2:this.props.index===1,ga=(("_5r8a")+(this.props.selected?' '+"_5r8b":'')+(ea.id==n.MRU_STICKER_PACK?' '+"_5qcj":'')+(ea.id==n.SEARCH_PACK_ID?' '+"_5qck":'')+(fa?' '+"_eb3":'')),ha=this.props.isComments&&!ea.isCommentsCapable,ia=u._("This pack is only available in photos"),ja=u._("This pack is only available in messages"),ka=ha?t:function(){return this.props.onClick(ea.id);}.bind(this),la=this._getPackIcon(ea);if(la===null)return null;var ma=ja;if(!ea.isMessengerCapable&&ea.isComposerCapable)ma=ia;return (j.createElement("a",{"aria-label":ha?ma:ea.name,className:ga,"data-id":ea.id,"data-hover":"tooltip",ref:"search_icon",onClick:ka,tabIndex:"0"},j.createElement(k,{className:((ha?"_2ji6":'')+(' '+"_5r8c")+(m.WebStickerSearch?' '+"_1viy":'')),src:la})));}});e.exports=ca;},null);
__d("StickersFlyoutTagSelector.react",["BanzaiLogger","Grid.react","ScrollableArea.react","Parent","React","Image.react","StickerConfig","StickerConstants","StickersFlyoutStickerSelector.react","StickerInterfaces","StickerSearch","StickerState","StickerUtils","Toggler","XUIButton.react","XUICloseButton.react","XUITextInput.react","cx","emptyFunction","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){b.__markCompiled&&b.__markCompiled();'use strict';var ba=h.GridItem,ca=k,da=ca.PropTypes,ea=320,fa=278,ga=44,ha=k.createClass({displayName:"StickersFlyoutTagSelector",propTypes:{trigger:da.string,stickerInterface:da.oneOf(aa(p)),resetTrigger:da.func,onSelectSticker:da.func},getInitialState:function(){return {input:'',isScrolling:false,tagChosen:false,matchedStickers:[]};},getDefaultProps:function(){return {trigger:null,stickerInterface:p.MESSAGES,resetTrigger:y,onSelectSticker:y};},componentDidMount:function(){var ia=j.byClass(k.findDOMNode(this),'uiToggle');if(ia)this._togglerSub=t.listen('show',ia,function(){this.isMounted()&&this.focusInput();}.bind(this));this.focusInput();this.selectTrigger(this.props.trigger);},componentWillUnmount:function(){this._togglerSub&&this._togglerSub.unsubscribe();},componentWillReceiveProps:function(ia){this.selectTrigger(ia.trigger);},focusInput:function(){this.refs.inputField.focusInput&&this.refs.inputField.focusInput();},_setMatchedStickers:function(ia){this.setState({matchedStickers:ia?ia:[]});},_onEnter:function(ia){ia.preventDefault();ia.stopPropagation();if(!m.EnterToSendSticker)return;var ja=this.state.matchedStickers;if(ja&&ja.length===1){this.props.onSelectSticker(ja[0].id,ia);this.setState({matchedStickers:[]});}},_inputChanged:function(ia){this.setState({input:ia.target.value,tagChosen:false,isScrolling:false});},_normalizeInput:function(ia){return ia.trim().replace(/\s+/,' ').toLowerCase();},_handleResetButtonClick:function(ia){ia.preventDefault();this.reset();},reset:function(){this.setState(this.getInitialState());},renderContentArea:function(){if(this.state.tagChosen||this._normalizeInput(this.state.input).length>1){return this.renderStickers();}else return m.StickerSearchInRecent?this.renderRecentStickers():this.renderTags();},render:function(){return (k.createElement("div",{className:(("_217a")+(this.state.isScrolling?' '+"_1hg1":''))},k.createElement("div",{className:"_5jdr"},k.createElement("span",{className:"_5jds"}),k.createElement(w,{onEnter:this._onEnter,onChange:this._inputChanged,ref:"inputField",placeholder:z._("Search stickers"),value:this.state.input}),k.createElement(v,{size:"small",onClick:this._handleResetButtonClick,className:((this.state.input.length===0?"hidden_elem":''))})),this.renderContentArea()));},selectTag:function(ia){g.log('StickersLoggerConfig',{event:'select_tag',tagid:ia.id});this.setState({tagChosen:true,input:s.capitalizeWords(ia.name)});this.focusInput();},selectTrigger:function(ia){if(ia!==null){var ja=q.getTagByName(ia);this.setState({tagChosen:true,input:s.capitalizeWords(ja.name)});this.props.resetTrigger();}},_onScroll:function(ia){this.setState({isScrolling:!!ia});},renderStickers:function(){var ia=this._normalizeInput(this.state.input);return (k.createElement(o,{ref:"selector",height:ea-ga,userInput:ia,onScroll:this._onScroll,stickerInterface:this.props.stickerInterface,tagChosen:this.state.tagChosen,onQueryResultsFound:this._setMatchedStickers}));},renderRecentStickers:function(){if(this._normalizeInput(this.state.input).length===1)return k.createElement("div",null);return (k.createElement(o,{ref:"selector",height:ea-ga,packID:n.MRU_STICKER_PACK,onScroll:this._onScroll,stickerInterface:this.props.stickerInterface}));},renderTags:function(){var ia=r.getFeaturedTags().filter(function(ja){return ja.sourceURI!==null;}).sort(function(ja,ka){return ja.order-ka.order;}).map(function(ja,ka){return k.createElement(ba,{key:ka},k.createElement("div",{className:(("_t5c")+(ka<2?' '+"_1b27":'')+(ka%2===0?' '+"_t5d":'')+(ka%2!==0?' '+"_t5e":''))},k.createElement(u,{image:k.createElement(l,{src:ja.sourceURI}),label:ja.name,onClick:this.selectTag.bind(this,ja),className:"_5jdu",style:{background:'#'+ja.color_code},disabled:this._normalizeInput(this.state.input).length===1})));}.bind(this));return (k.createElement(i,{height:ea-ga,width:fa-16,shadow:true,fade:true,className:"_5jei"},k.createElement(h,{spacing:"pas",cols:2,fixed:true,ref:"grid"},ia)));}});e.exports=ha;},null);
__d("StickersFlyout.react",["BanzaiLogger","Event","Keys","MessagesEmoticons.react","Parent","ReactComponentWithPureRenderMixin","React","StickerConstants","StickerConfig","StickersFlyoutPackSelector.react","StickersFlyoutStickerSelector.react","StickersFlyoutTagSelector.react","StickerInterfaces","StickerState","StickerStateStore","StoreAndPropBasedStateMixin","SubscriptionsHandler","Toggler","XUISpinner.react","cx","getObjectValues","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){b.__markCompiled&&b.__markCompiled();'use strict';var ca=m,da=ca.PropTypes,ea=n.SEARCH_PACK_ID,fa=m.createClass({displayName:"StickersFlyout",mixins:[l,v(u)],statics:{calculateState:function(ga){var ha=u.getState(ga.stickerInterface);return {dataReady:ha.trayDataReady,packID:ha.packID,numNewPacks:ha.numNewPacks,packs:ha.trayPacks};}},propTypes:{stickerInterface:da.oneOf(aa(s)),onStickerSelect:da.func.isRequired,onEmoticonSelect:da.func,onShown:da.func,onHidden:da.func,onEscKeyDown:da.func,onPackSelect:da.func,shown:da.bool},getDefaultProps:function(){return {stickerInterface:s.MESSAGES,shown:false,packSelectorClass:p,tagSelectorClass:r,glyphProvider:null};},getInitialState:function(){return {trigger:null};},componentDidMount:function(){if(o.LoadStickerEarly&&!this.state.dataReady)this.loadTrayData();this._toggle=k.byClass(m.findDOMNode(this),'uiToggle');this._subscriptions=new w();if(this._toggle)this._subscriptions.addSubscriptions(x.listen('show',this._toggle,this._onShownWrapper),x.listen('hide',this._toggle,this._onHidden));this._subscriptions.addSubscriptions(h.listen(m.findDOMNode(this),'keydown',this._onKeyDown));if(this.props.shown)this._onShown();},_onShownWrapper:function(){if(this.props.onShown){this.props.onShown(this._onShown);}else this._onShown();},_onShown:function(){g.log('StickersLoggerConfig',{event:'open_tray'});if(!o.LoadStickerEarly&&!this.state.dataReady)this.loadTrayData();if(this.state.packID===ea)this.refs.tagSelector&&this.refs.tagSelector.focusInput();this.refs.packSelector.onFlyoutShown();},_onHidden:function(){this.resetTagSelector();this.props.onHidden&&this.props.onHidden();},componentWillUnmount:function(){this._subscriptions.release();},componentWillReceiveProps:function(ga){if(!this.state.dataReady&&ga.shown)this.loadTrayData();},componentDidUpdate:function(ga){if(!ga.shown&&this.props.shown){this._onShown();}else if(ga.shown&&!this.props.shown)this._onHidden();},_onKeyDown:function(event){if(event.keyCode===i.ESC&&this.props.onEscKeyDown){this.props.onEscKeyDown();event.kill();}if(event.keyCode===i.RETURN&&this.props.stickerInterface===s.COMMENTS)this.selectedSticker(event);},resetTagSelector:function(){this.refs.tagSelector&&this.refs.tagSelector.reset();},loadTrayData:function(){t.onTrayDataReady(function(){}.bind(this));},loadPack:function(){if(!this.state.dataReady)return (m.createElement("div",{className:"_e0r"},m.createElement(y,{size:"large"})));if(this.state.packID===n.EMOTICON_PACK_ID)return (m.createElement("div",{className:"_5r8l","data-id":this.state.packID},m.createElement(j,{onEmoticonSelect:this.props.onEmoticonSelect})));if(this.state.packID===ea&&o.WebStickerSearch){var ga=this.props.tagSelectorClass;return (m.createElement("div",{className:"_5r8l"},m.createElement(ga,{ref:"tagSelector",className:"fbStickersFlyoutTagSelector",trigger:this.state.trigger,resetTrigger:function(){return this.setState({trigger:null});}.bind(this),stickerInterface:this.props.stickerInterface,onSelectSticker:this.onSelectSticker})));}return (m.createElement("div",{className:"_5r8l","data-id":this.state.packID},m.createElement(q,{ref:"selector",packID:this.state.packID,stickerInterface:this.props.stickerInterface})));},onSelectSticker:function(ga,event){if(ga){t.updateRecentlyUsed(ga);this.props.onStickerSelect(ga,event);if(o.PromotePackFromSearch&&this.state.packID===n.SEARCH_PACK_ID)t.promotePackSentFromSearch(ga);t.clearShowStickerReplyNUX();}},selectedSticker:function(event){var ga=k.byClass(event.target,"_5r8h");if(ga){var ha=ga.getAttribute('data-id');this.onSelectSticker(ha,event);}},render:function(){var ga=this.props.packSelectorClass;return (m.createElement("div",{className:ba(this.props.className,"_5r8f")},m.createElement("div",{className:"_5r8e"},m.createElement(ga,{ref:"packSelector",numNewPacks:this.state.numNewPacks,onPackClick:this.props.onPackSelect,selectedPackID:this.state.packID,packs:this.state.packs,stickerInterface:this.props.stickerInterface,resetTagSelectorFunc:this.resetTagSelector,glyphProvider:this.props.glyphProvider})),m.createElement("div",{className:"_5r8m",onClick:this.selectedSticker},this.loadPack())));}});e.exports=fa;},null);