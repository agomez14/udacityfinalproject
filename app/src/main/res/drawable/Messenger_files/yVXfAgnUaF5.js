/*!CK:1628279914!*//*1438207338,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["wOOlh"]); }

__d("MercuryAttachmentConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={SIDE_LENGTH:9};e.exports=g;},null);
__d("FileFormResetOnSubmit",["DOMQuery","Event","emptyFunction"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(l,m){var n=h.listen(l,'change',i.thatReturnsFalse,h.Priority.URGENT);try{m();}catch(o){throw o;}finally{n.remove();}}function k(l){"use strict";this._form=l;}k.prototype.enable=function(){"use strict";var l=this._reset.bind(this);this._subscription=this._form.subscribe('submit',function(){setTimeout(l,0);});};k.prototype.disable=function(){"use strict";this._subscription.unsubscribe();this._subscription=null;};k.prototype._reset=function(){"use strict";var l=this._form.getRoot();j(l,function(){var m=g.scry(l,'input[type="file"]');m.forEach(function(n){n.value='';});});};e.exports=k;},null);
__d("FormSubmitOnChange",["Event","submitForm"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j){"use strict";this._form=j;}i.prototype.enable=function(){"use strict";this._listener=g.listen(this._form.getRoot(),'change',this._submit.bind(this));};i.prototype.disable=function(){"use strict";this._listener.remove();this._listener=null;};i.prototype._submit=function(){"use strict";h(this._form.getRoot());};Object.assign(i.prototype,{_listener:null});e.exports=i;},null);
__d("MercuryFileUploader",["ArbiterMixin","CSS","Dialog","DOM","Event","FileForm","FileFormResetOnSubmit","FileInput","FormSubmitOnChange","MercuryAttachment","MercuryAttachmentTemplates","MercuryConstants","PhotosUploadID","SubscriptionsHandler","csx","fbt","getObjectValues","mixin","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){b.__markCompiled&&b.__markCompiled();var z=x(g);for(var aa in z)if(z.hasOwnProperty(aa))ca[aa]=z[aa];var ba=z===null?null:z.prototype;ca.prototype=Object.create(ba);ca.prototype.constructor=ca;ca.__superConstructor__=z;function ca(ea,fa,ga,ha){"use strict";z.call(this);this.$MercuryFileUploader0=ea;this.$MercuryFileUploader1={};this.$MercuryFileUploader2={};this.$MercuryFileUploader3={};this.$MercuryFileUploader4={};this.$MercuryFileUploader5={};this.$MercuryFileUploader6={};this.$MercuryFileUploader7={};this.$MercuryFileUploader8={};this.$MercuryFileUploader9={};this.updateElements(fa,ga,ha);}ca.prototype.updateElements=function(ea,fa,ga){"use strict";this.$MercuryFileUploadera&&this.$MercuryFileUploadera.release();this.$MercuryFileUploadera=new t();this.$MercuryFileUploaderb&&this.$MercuryFileUploaderb.destroy();this.$MercuryFileUploaderb=new l(ea,[o,m]);this.$MercuryFileUploaderb.setAllowCrossOrigin(true);this.$MercuryFileUploaderb.setUploadInParallel(true);var ha=j.find(ea,"._4q60"),ia=j.find(ha,"._4q61");new n(ha,ia,fa);this.$MercuryFileUploadera.addSubscriptions(this.$MercuryFileUploaderb.subscribe('submit',function(){var ja={count:0,file_sizes:[]};if(fa.files){for(var ka=0;ka<fa.files.length;ka++)if(fa.files[ka].size>r.AttachmentMaxSize){this.showAttachmentSizeErrorDialog();return false;}var la={};for(var ma=0;ma<fa.files.length;ma++){var na=this.$MercuryFileUploaderc();this.$MercuryFileUploaderd(na,fa.files[ma].name);ja.count++;ja.file_sizes.push(fa.files[ma].size);la[na]=fa.files[ma];}this.$MercuryFileUploaderb.setFiles(la);}else{ga.value=this.$MercuryFileUploaderc();this.$MercuryFileUploaderd(ga.value,fa.value);ja.count=1;}this.inform('submit',ja);}.bind(this)),this.$MercuryFileUploaderb.subscribe('success',this.$MercuryFileUploadere.bind(this)),this.$MercuryFileUploaderb.subscribe('failure',this.$MercuryFileUploaderf.bind(this)),k.listen(ia,'click',y(this.inform,this,'open')));};ca.prototype.showAttachmentSizeErrorDialog=function(){"use strict";this.$MercuryFileUploaderb.abort();this.$MercuryFileUploaderb.clear();new i().setTitle(v._("The file you have selected is too large")).setBody(v._("The file you have selected is too large. The maximum size is 25MB.")).setButtons(i.OK).setSemiModal(true).show();};ca.prototype.addDroppedFiles=function(ea){"use strict";if(!this.$MercuryFileUploaderb||!this.$MercuryFileUploaderb.canUseXHR())return;var fa={},ga={count:0,file_sizes:[]};for(var ha=0;ha<ea.length;ha++){var ia=ea[ha];if(ia.size>r.AttachmentMaxSize){this.showAttachmentSizeErrorDialog();return false;}var ja=this.$MercuryFileUploaderc();this.$MercuryFileUploaderd(ja,ia.name);fa[ja]=ia;ga.file_sizes.push(ia.size);ga.count++;}this.$MercuryFileUploaderb.setFiles(fa);this.$MercuryFileUploaderb.forceSendViaXHR();this.inform('submit',ga);};ca.prototype.isUploading=function(){"use strict";return !!Object.keys(this.$MercuryFileUploader7).length;};ca.prototype.addCachedAttachments=function(ea){"use strict";ea.forEach(function(fa){var ga=this.$MercuryFileUploaderc();this.$MercuryFileUploaderd(ga,fa.filename);this.$MercuryFileUploaderg(ga,fa);}.bind(this));};ca.prototype.addCachedImageFiles=function(ea){"use strict";var fa=v._("Photo");ea.forEach(function(ga){var ha=this.$MercuryFileUploaderc();this.$MercuryFileUploaderd(ha,fa);this.$MercuryFileUploaderg(ha,{filename:ga,image_id:ga,filetype:'image/jpeg'});}.bind(this));};ca.prototype.getAttachments=function(){"use strict";return w(this.$MercuryFileUploader1);};ca.prototype.getImageFiles=function(){"use strict";var ea=Object.keys(this.$MercuryFileUploader2).sort(),fa=[];ea.forEach(function(ga){return fa.push(this.$MercuryFileUploader2[ga]);}.bind(this));return fa;};ca.prototype.getAnimatedImageFiles=function(){"use strict";return w(this.$MercuryFileUploader3);};ca.prototype.getVideoFiles=function(){"use strict";return w(this.$MercuryFileUploader4);};ca.prototype.getAudioFiles=function(){"use strict";return w(this.$MercuryFileUploader5);};ca.prototype.getFiles=function(){"use strict";return w(this.$MercuryFileUploader6);};ca.prototype.removeAttachments=function(){"use strict";if(this.$MercuryFileUploader0)j.empty(this.$MercuryFileUploader0);this.$MercuryFileUploader1={};this.$MercuryFileUploader2={};this.$MercuryFileUploader3={};this.$MercuryFileUploader4={};this.$MercuryFileUploader5={};this.$MercuryFileUploader6={};this.$MercuryFileUploader8={};this.$MercuryFileUploader7={};this.$MercuryFileUploader9={};if(this.$MercuryFileUploader0)h.hide(this.$MercuryFileUploader0);this.inform('dom-updated');};ca.prototype.destroy=function(){"use strict";this.$MercuryFileUploadera&&this.$MercuryFileUploadera.release();this.$MercuryFileUploaderb&&this.$MercuryFileUploaderb.destroy();this.removeAttachments();};ca.prototype.$MercuryFileUploaderd=function(ea,fa){"use strict";var ga=q[':fb:mercury:upload-file-row'].build();this.$MercuryFileUploader8[ea]=ga;this.$MercuryFileUploader7[ea]=true;this.$MercuryFileUploader9[ea]=Date.now();j.appendContent(ga.getNode('iconText'),da(fa));k.listen(ga.getNode('closeFileUpload'),'click',this.$MercuryFileUploaderh.bind(this,ea));if(this.$MercuryFileUploader0){j.appendContent(this.$MercuryFileUploader0,ga.getRoot());h.show(this.$MercuryFileUploader0);}this.inform('dom-updated');};ca.prototype.$MercuryFileUploaderh=function(ea,event){"use strict";if(this.$MercuryFileUploader7[ea]){this.inform('upload-canceled-during-upload');}else if(this.$MercuryFileUploader1[ea]||this.$MercuryFileUploader2[ea]||this.$MercuryFileUploader3[ea]||this.$MercuryFileUploader4[ea]||this.$MercuryFileUploader5[ea]||this.$MercuryFileUploader6[ea])this.inform('upload-canceled-after-uploaded');delete this.$MercuryFileUploader1[ea];delete this.$MercuryFileUploader2[ea];delete this.$MercuryFileUploader3[ea];delete this.$MercuryFileUploader4[ea];delete this.$MercuryFileUploader5[ea];delete this.$MercuryFileUploader6[ea];delete this.$MercuryFileUploader7[ea];delete this.$MercuryFileUploader9[ea];var fa=this.$MercuryFileUploader8[ea];delete this.$MercuryFileUploader8[ea];if(fa){j.remove(fa.getRoot());this.inform('dom-updated');}this.inform('upload-canceled');return false;};ca.prototype.$MercuryFileUploaderi=function(ea,fa){"use strict";var ga=this.$MercuryFileUploader8[ea],ha=p.getAttachIconClassByMime(fa);h.addClass(ga.getNode('iconText'),ha);h.addClass(ga.getRoot(),'done');};ca.prototype.$MercuryFileUploaderg=function(ea,fa){"use strict";if(this.$MercuryFileUploader7[ea]){delete this.$MercuryFileUploader7[ea];if(fa.image_id){this.$MercuryFileUploader2[ea]=fa.image_id;}else if(fa.gif_id){this.$MercuryFileUploader3[ea]=fa.gif_id;}else if(fa.video_id){this.$MercuryFileUploader4[ea]=fa.video_id;}else if(fa.audio_id){this.$MercuryFileUploader5[ea]=fa.audio_id;}else if(fa.file_id){this.$MercuryFileUploader6[ea]=fa.file_id;}else this.$MercuryFileUploader1[ea]=fa;this.$MercuryFileUploaderi(ea,fa.filetype);this.inform('one-upload-completed',{upload_time_ms:Date.now()-this.$MercuryFileUploader9[ea]});}if(!this.isUploading())this.inform('all-uploads-completed',{count:this.getAttachments().length});};ca.prototype.$MercuryFileUploadere=function(event,ea){"use strict";var fa=ea.response.getPayload();this.$MercuryFileUploaderg(this.$MercuryFileUploaderj(ea),fa.metadata[0]);};ca.prototype.$MercuryFileUploaderf=function(event,ea){"use strict";this.inform('one-upload-failed');this.$MercuryFileUploaderh(this.$MercuryFileUploaderj(ea),event);};ca.prototype.$MercuryFileUploaderc=function(){"use strict";return 'upload_'+s.getNewID();};ca.prototype.$MercuryFileUploaderj=function(ea){"use strict";var fa=ea.response.getPayload();if(ea.upload){return ea.upload.getName();}else return fa.uploadID;};function da(ea){if(ea&&ea.startsWith('C:\\fakepath\\'))return ea.substring(12);return ea;}e.exports=ca;},null);
__d("ChatImageArrowDirection",["keyMirror"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h=g({BOTH:null,LEFT:null,RIGHT:null});e.exports=h;},null);
__d("ChatImageWithArrow.react",["BackgroundImage.react","ChatImageArrowDirection","Link.react","MercuryAttachmentConstants","MercuryConfig","React","XUISpinner.react","cx","getVendorPrefixedName","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=l,r=q.PropTypes,s=30,t=15,u=l.createClass({displayName:"ChatImageWithArrow",propTypes:{arrowDirection:r.oneOf(Object.keys(h)),onClick:r.func,height:r.number.isRequired,isLoading:r.bool,rootClassName:r.string,sideLength:r.number,source:r.string,width:r.number.isRequired},getDefaultProps:function(){return {sideLength:j.SIDE_LENGTH,isLoading:false};},render:function(){this._arrowWidth=Math.floor(this.props.sideLength/Math.sqrt(2));this._extendedPhotoWidth=Math.ceil(this._getWidth()+this._arrowWidth);if(this.props.isLoading)return this._renderUploadingBubble();var v=p((("_4yp6")+(this.props.arrowDirection!==h.BOTH?' '+"_2nlo":'')),this.props.rootClassName),w,x;switch(this.props.arrowDirection){case h.BOTH:w=[this._renderArrowWithBorder(h.LEFT),this._renderArrowWithBorder(h.RIGHT)];x=[this._renderArrowWithNoBorder(h.LEFT),this._renderArrowWithNoBorder(h.RIGHT)];break;case h.LEFT:case h.RIGHT:w=this._renderArrowWithBorder(this.props.arrowDirection);x=this._renderArrowWithNoBorder(this.props.arrowDirection);break;}return this._renderLink(l.createElement("div",{className:v},k.ChatTabMessengerStyle?null:w,l.createElement("div",{className:"_52kr",style:{width:this._getWidth(),height:this._getHeight()}},l.createElement("div",{className:"_4yp9",style:{backgroundImage:'url('+this.props.source+')',width:this._extendedPhotoWidth,height:this._getHeight()}})),k.ChatTabMessengerStyle?null:x));},_getWidth:function(){return Math.max(this.props.width,t);},_getHeight:function(){return Math.max(this.props.height,s);},_renderLink:function(v){if(this.props.onClick)return (l.createElement(i,{onClick:this.props.onClick},v));return v;},_calculateArrowTransform:function(v,w,x,y){if(w===h.LEFT){return 'translate('+x+'px, '+y+'px)'+'rotate(45deg)';}else return 'translate('+(v-x)+'px, '+y+'px)'+'rotate(45deg)';},_calculateArrowImageTransform:function(v,w,x,y){if(w===h.LEFT){return 'rotate(-45deg)'+'translate(-'+(this._arrowWidth+x)+'px,'+'-'+y+'px)';}else return 'rotate(-45deg)'+'translate(-'+(v-x)+'px, -'+y+'px)';},_renderUploadingBubble:function(){var v={width:this.props.sideLength,height:this.props.sideLength};if(this.props.source)v.backgroundImage='url('+this.props.source+')';var w={width:this.props.sideLength,height:this.props.sideLength};if(this.props.source)w.opacity=0;var x=o('transform');if(x){v[x]=this._calculateArrowTransform(this._getWidth(),this.props.arrowDirection,0,this.props.sideLength);w[x]=this._calculateArrowTransform(this._getWidth(),this.props.arrowDirection,0,Math.floor(this.props.sideLength-this._getHeight()));}var y={width:this._getWidth(),height:this._getHeight()};if(this.props.source){y.backgroundImage='url('+this.props.source+')';y.backgroundSize='cover';}return (l.createElement("div",{className:"_4yp6"},l.createElement("div",{className:"_4ypa",style:v}),l.createElement("div",{className:"_4ypb",style:y},l.createElement(m,{size:"small"})),l.createElement("div",{className:"_4ype",style:w})));},_renderArrowWithBorder:function(v){var w={width:this.props.sideLength,height:this.props.sideLength},x={},y=o('transform');if(y){w[y]=this._calculateArrowTransform(this._getWidth(),v,0,this.props.sideLength);x[y]=this._calculateArrowImageTransform(this._getWidth(),v,0,this.props.sideLength);return (l.createElement("div",{className:(("_4ypf")+(v===h.LEFT?' '+"_2nlp":'')+(v===h.RIGHT?' '+"_2nlq":'')),key:'border:'+v,style:w},l.createElement(g,{backgroundSize:"cover",className:"_4ypg",height:this._getHeight(),src:this.props.source,style:x,width:this._extendedPhotoWidth})));}},_renderArrowWithNoBorder:function(v){var w={width:this.props.sideLength,height:this.props.sideLength},x={},y=1,z=o('transform');if(z){w[z]=this._calculateArrowTransform(this._getWidth(),v,y,this.props.sideLength-this._getHeight());x[z]=this._calculateArrowImageTransform(this._getWidth(),v,y,this.props.sideLength);}return (l.createElement("div",{className:(("_4yph")+(v===h.LEFT?' '+"_2nlp":'')+(v===h.RIGHT?' '+"_2nlq":'')),key:'noBorder:'+v,style:w},l.createElement(g,{backgroundSize:"cover",className:"_4ypg",height:this._getHeight(),src:this.props.source,style:x,width:this._extendedPhotoWidth})));}});e.exports=u;},null);
__d("MessengerAttachmentImageBlock.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"MessengerAttachmentImageBlock",propTypes:{attachment:k.object.isRequired},render:function(){return (g.createElement("div",{className:i(this.props.className,this._computeClass())},this._renderImage(),g.createElement("div",{className:"_5swm"},this.props.children)));},_renderImage:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return null;var n=this._getDimensions(),o=n.height,p=n.width,q=o>p,r=m(o,p),s=o&&p?o/p*100:100,t=(q||r)?.2:1,u=(q||r)?s:52,v={backgroundImage:'url('+this.props.attachment.media.image+')',minHeight:'0px',paddingBottom:q&&s>150?'136px':u*t+'%'};if(this.props.attachment.description&&this.props.attachment.source)v.minHeight='112px';return (g.createElement("div",{className:"_3xn1",style:v}));},_computeClass:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return "_3xn3 _5swn";var n=this._getDimensions(),o=n.height,p=n.width,q=o>p;return (("_3xn3")+(m(o,p)&&!q?' '+"_3xn5":'')+(q?' '+"_3xn6":'')+(p>=o?' '+"_3xn7":''));},_getDimensions:function(){var n=this.props.attachment.properties||{},o=n.height,p=n.width;if(o&&p){o=parseInt(o,10);p=parseInt(p,10);return {height:o,width:p};}return {height:0,width:0};}});function m(n,o){return n<=300&&o<=300;}e.exports=l;},null);
__d("MercuryShareImage.react",["ChatImageArrowDirection","ChatImageWithArrow.react","React","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=i.createClass({displayName:"MercuryShareImage",propTypes:{height:l.number.isRequired,source:l.string.isRequired,width:l.number.isRequired},render:function(){return (i.createElement("div",{className:"_4hsl"},i.createElement(h,{arrowDirection:g.BOTH,height:this.props.height,source:this.props.source,width:this.props.width})));}});e.exports=m;},null);
__d("MercuryFallbackShareAttachmentContent.react",["Image.react","ImageBlock.react","LineClamp.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","MercuryShareImage.react","MessengerAttachmentImageBlock.react","React","URI","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=n,s=r.PropTypes,t=72,u=n.createClass({displayName:"MercuryFallbackShareAttachmentContent",propTypes:{attachment:k,location:s.oneOf(j.getValues())},render:function(){var v=this.props.attachment,w=this.props.location,x=((j.CHAT===w?"_49or":'')+(j.WEB_INBOX===w?' '+"__nm":'')+(j.CHAT_PREVIEW===w?' '+"_324d":'')+(j.CHAT!==w?' '+"_tih":'')+(!(v&&v.media.image)?' '+"_49ou":'')),y=this._renderTextBlock();if(v.media&&v.media.image){if(j.CHAT===w||j.CHAT_PREVIEW===w){return (n.createElement(h,{className:x,spacing:"medium"},n.createElement(l,{height:t,source:v.media.image,width:t}),n.createElement("div",{style:{display:'flex',justifyContent:'center',flexDirection:'column',height:t}},y)));}else if(j.MESSENGER===w){var z;if(v.description)z=(n.createElement("div",{className:"__6l"},n.createElement(i,{customEllipsis:" ",lines:2,lineHeight:16},v.description)));var aa;if(v.title)aa=(n.createElement("div",{className:"__6k"},n.createElement(i,{customEllipsis:" ",lines:2,lineHeight:18},v.title)));var ba;if(v.source)ba=(n.createElement("div",{className:"__6m"},v.source));return (n.createElement(m,{className:x,attachment:v},n.createElement("div",{className:"__6j"},aa,z,ba),this.props.children));}return (n.createElement(h,{className:q(this.props.className,x)},n.createElement(g,{className:"__6n",src:v.media.image,width:t}),y,this.props.children));}return (n.createElement("div",{className:q(this.props.className,x)},y,this.props.children));},_renderTextBlock:function(){var v=this.props,w=v.attachment,x,y,z;if(w.title)x=(n.createElement("div",{className:"__6k"},w.title));if(w.description)y=(n.createElement("div",{className:"__6l"},w.description));if(w.source)z=(n.createElement("div",{className:"__6m"},w.source));return (n.createElement("div",{className:"__6j"},x,y,z));}});e.exports=u;},null);
__d("MercuryFallbackShareAttachment.react",["Link.react","MercuryFallbackShareAttachmentContent.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=k,n=m.PropTypes,o=k.createClass({displayName:"MercuryFallbackShareAttachment",propTypes:{attachment:j,location:n.oneOf(i.getValues())},renderLink:function(p){if(i.isPreview(this.props.location))return p;return (k.createElement(g,{className:"_5rw4",href:this.props.attachment.uri,target:"_blank"},p));},render:function(){return this.renderLink(k.createElement(h,k.__spread({},this.props)));}});e.exports=o;},null);
__d("MercurySharePreview.react",["AsyncRequest","LeftRight.react","MercuryFallbackShareAttachment.react","MercuryShareAttachmentRenderLocations","React","XUICloseButton.react","XUISpinner.react","cx","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=k,q=p.PropTypes,r=k.createClass({displayName:"MercurySharePreview",propTypes:{imageSize:q.shape({width:q.number.isRequired,height:q.number.isRequired}).isRequired,location:q.oneOf(j.getValues()).isRequired,share:q.shape({params:q.array,type:q.number}),uri:q.string,onClose:q.func,onUpdate:q.func},getInitialState:function(){return {attachmentData:null,loading:false};},componentWillMount:function(){this._requestID=1337;this._currentRequest=null;},componentWillUnmount:function(){this._reset();},componentWillReceiveProps:function(s){o(!(s.share&&s.uri));if(!s.share&&!s.uri)return this._reset();var t=this.state.attachmentData||this.state.loading;if(s.share&&!t){this._loadFromShare(s.share);}else if(s.uri&&!(t&&this.props.uri==s.uri))this._loadFromURI(s.uri);},componentDidUpdate:function(s,t){this.props.onUpdate&&this.props.onUpdate(this);},getShareData:function(){return this.state.attachmentData&&this.state.attachmentData.share_data;},isLoading:function(){return this.state.loading;},_loadFromShare:function(s){this._currentRequest=new g().setURI('/message_share_attachment/fromParams/').setData({image_height:this.props.imageSize.height,image_width:this.props.imageSize.width,share_params:s.params,share_type:s.type}).setHandler(this._onShareLoaded.bind(this,this._getNextRequestID()));this._currentRequest.send();this.setState({loading:true,attachmentData:null});},_loadFromURI:function(s){this._currentRequest=new g().setURI('/message_share_attachment/fromURI/').setData({image_height:this.props.imageSize.height,image_width:this.props.imageSize.width,uri:s}).setHandler(this._onShareLoaded.bind(this,this._getNextRequestID()));this._currentRequest.send();this.setState({loading:true,attachmentData:null});},_getNextRequestID:function(){return (++this._requestID);},_getCurrentRequestID:function(){return this._requestID;},_onShareLoaded:function(s,t){if(this._getCurrentRequestID()!==s)return;this.setState({loading:false,attachmentData:t.payload});},_close:function(){this._reset();this.props.onClose&&this.props.onClose();},_reset:function(){this._getNextRequestID();this._currentRequest&&this._currentRequest.abort();this._currentRequest=null;this.setState({loading:false,attachmentData:null});},render:function(){var s=(("_tig")+(' '+"_tih"));if(this.state.loading)return (k.createElement(h,{direction:h.DIRECTION.right,className:s},k.createElement(m,{className:"_tii",size:"large",background:"light"}),k.createElement(l,{className:"_tij",shade:"dark",size:"small",onClick:this._close})));var t=this.state.attachmentData;if(!t)return k.createElement("div",null);return (k.createElement("div",null,k.createElement(l,{className:"_tij",shade:"dark",size:"small",onClick:this._close}),k.createElement(i,{attachment:t,location:j.CHAT_PREVIEW})));}});e.exports=r;},null);